# Morse Code Game - Интерактивная игра по азбуке Морзе

Полноценная игра на Python для изучения и практики азбуки Морзе с телеграфным ключом или клавиатурой. Идеально подходит для образовательных целей, тренировки навыков азбуки Морзе или как развлекательное приложение с геймплеем.

## Возможности

- **Игровые режимы**: Основная игра с очками и временем, режим практики для отдельных букв
- **Система очков**: Подсчет очков, таблица рекордов, бонусы времени за последовательные правильные ответы
- **Уровни сложности**: Легкий и сложный режимы с разными временными ограничениями и длиной слов
- **Аппаратная интеграция**: Поддержка телеграфного ключа через GPIO и аналогового мегомметра

## Аппаратные требования

- Raspberry Pi 4 Model B (или совместимая модель)
- Монитор
- Телеграфный ключ или кнопка
- Соединительные провода

## Подключение

### Базовое подключение телеграфного ключа
Подключите телеграфный ключ к Raspberry Pi:

- Один провод к GPIO 17 (нумерация BCM) - телеграфный ключ
- Второй провод к GND

```
Телеграфный ключ → GPIO 17
                → GND
```

### Подключение аналогового мегомметра (опционально)
Для визуальной обратной связи с аналоговой стрелкой:

- Основная катушка → GPIO 13 (PWM)
- Оттягивающая катушка → GPIO 12 (PWM)
- Общий провод → GND

```
Мегомметр → GPIO 13 (основная катушка)
          → GPIO 12 (оттягивающая катушка)
          → GND
```

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/yourusername/morse-game.git
   cd morse-game
   ```

2. Установите зависимости:
   ```bash
   sudo apt-get update
   sudo apt-get install python3-pip python3-pygame
   pip3 install -r requirements.txt
   ```

## Игровые режимы

### Основная игра
- **Цель**: Набрать как можно больше очков, вводя слова азбукой Морзе
- **Время**: 90 секунд на игру с бонусным временем за правильные слова
- **Сложность**: Два уровня (легкий и сложный) с разными временными ограничениями
- **Очки**: Начисляются за скорость и точность ввода

### Режим практики
- **Цель**: Тренировка ввода отдельных букв азбуки Морзе
- **Без времени**: Неограниченное время для отработки каждой буквы
- **Обратная связь**: Мгновенная индикация правильности ввода

### Таблица рекордов
- Автоматическое сохранение лучших результатов
- Сортировка по очкам и времени
- Хранение до 9 лучших результатов

## Быстрый запуск

```bash
# Основной режим (полноэкранный, авто-определение ввода)
python main.py

# Оконный режим для разработки
python main.py --window

# Режим клавиатуры для тестирования
python main.py --window --keyboard

# GPIO режим для Raspberry Pi
python main.py --gpio

# Отладочный режим
python main.py --window --keyboard --debug

# Оптимизация производительности для Raspberry Pi 4
python main.py --high-performance  # Отключает все эффекты, 15 FPS
python main.py --no-crt           # Отключает CRT-эффект
python main.py --no-neon          # Отключает неоновые эффекты
python main.py --low-fps          # Устанавливает 10 FPS
```

## Управление в игре

### Меню
- **Стрелки вверх/вниз** - навигация по пунктам меню
- **Enter** - выбор пункта меню
- **ESC** - выход из игры

### В игре
- **Пробел** - ввод точки/тире (клавиатурный режим)
- **C** - очистить текущий ввод
- **ESC** - пауза/выход в меню
- **F11** - переключить полноэкранный режим

### Азбука Морзе
- **Короткое нажатие** (·) - точка
- **Длинное нажатие** (—) - тире
- **Короткая пауза** - разделение букв
- **Длинная пауза** - разделение слов

## Аргументы командной строки

- `--window` - оконный режим вместо полноэкранного
- `--keyboard` - принудительный режим клавиатуры
- `--gpio` - принудительный режим GPIO
- `--debug` - отладочный режим
- `--high-performance` - высокопроизводительный режим (15 FPS, без эффектов)
- `--no-crt` - отключить CRT-эффект
- `--no-neon` - отключить неоновые эффекты
- `--low-fps` - понизить частоту кадров до 10 FPS
- `--no-hw-accel` - отключить аппаратное ускорение
- `--no-vsync` - отключить VSync
- `--no-smooth-startup` - отключить плавный запуск (уменьшает задержку)
- `--force-windowed` - принудительно оконный режим (если полноэкранный не работает)
- `--disable-hw-fullscreen` - отключить аппаратное ускорение в полноэкранном режиме

## Оптимизация производительности для Raspberry Pi 4

Для лучшей производительности на Raspberry Pi 4:

### Автоматическая оптимизация
Приложение автоматически определяет Raspberry Pi и применяет:
- Снижение FPS до 15
- Отключение CRT-эффектов по умолчанию
- Отключение неоновых эффектов по умолчанию
- Аппаратное ускорение GPU
- VSync для плавной прорисовки
- Двойная буферизация

### Масштабирование разрешения
- **Целевое разрешение**: 1024x768 для оптимальной производительности
- **Авто-масштабирование**: на 2K+ мониторах игра рендерится в 1024x768 и масштабируется до нативного разрешения
- **Сохранение производительности**: частота кадров остается стабильной независимо от разрешения монитора

## Структура проекта

```
morse_game/
├── main.py                 # Точка входа в приложение
├── requirements.txt        # Зависимости Python
├── README.md              # Документация
├── src/                   # Исходный код
│   ├── app.py             # Основное приложение и инициализация
│   ├── core/              # Основная логика игры
│   │   ├── config.py      # Конфигурация и настройки
│   │   ├── game_controller.py  # Контроллер игрового процесса
│   │   ├── game_state.py      # Управление состояниями игры
│   │   ├── morse_decoder.py   # Декодер азбуки Морзе
│   │   └── word_generator.py  # Генератор слов для игры
│   ├── ui/                # Пользовательский интерфейс
│   │   └── renderer.py   # Отрисовка интерфейса и эффектов
│   ├── input/             # Обработка ввода
│   │   ├── event_handler.py   # Обработка событий pygame
│   │   └── gpio_handler.py    # Работа с GPIO Raspberry Pi
│   ├── hardware/          # Аппаратная интеграция
│   │   └── megohmmeter_control.py  # Управление аналоговым мегомметром
│   └── data/              # Данные и сохранения
│       └── high_scores.py # Управление таблицей рекордов
└── fonts/                 # Шрифты для интерфейса
    └── font9x16.ttf      # Основной шрифт
```

## Требования

### Системные требования
- Python 3.7+
- Pygame 2.1.0+
- GPIO Zero (только для Raspberry Pi)

### Зависимости
```bash
pip install -r requirements.txt
```

Содержимое `requirements.txt`:
```
gpiozero>=1.6.0  # Для работы с GPIO Raspberry Pi
pygame>=2.1.0    # Игровой движок и отрисовка
```

## Лицензия

Проект распространяется под лицензией MIT. Подробности в файле LICENSE.
